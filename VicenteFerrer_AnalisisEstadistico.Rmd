

---
title: 'Estadística Avanzada: A2 - Analítica descriptiva e inferencial'
author: "Autor: Raúl Vicente Ferrer"
date: "Noviembre 2021"
output:
  html_document:
    highlight: default
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_depth: 2
  pdf_document:
    highlight: zenburn
    toc: yes
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval=T, echo=T)

```

```{r echo=TRUE, message=FALSE, warning=FALSE}
# https://cran.r-project.org/web/packages/ggplot2/index.html
if (!require('ggplot2')) install.packages('ggplot2'); library('ggplot2')
# https://cran.r-project.org/web/packages/nortest/index.html
if (!require('nortest')) install.packages('nortest'); library('nortest')
```

******
# Lectura del fichero y preparación de los datos
******

```{r message= FALSE, warning=FALSE}
claim <- read.csv("./train_clean2.csv", header=TRUE) 
str(claim)
summary(claim)
```

******
# Coste de los siniestros  
******

## Análisis visual

* Diagrama de caja de la distribución de la variable 'UltCost':

```{r}
boxplot(claim$UltCost, main="UltCost")
```

* Transformación a escala logarítmica de la variable 'UltCost' y diagrama de caja:

```{r}
logUltCost <- log(claim$UltCost)
boxplot(logUltCost, main="Log UltCost")
```

* Interpretación de los gráficos:
El primer gráfico presenta una fuerte asimetría a la izquierda.
Trás aplicar la transformación logarítmica, podemos ver que los valores se distribuyen entre 2 y 13.


## Comprobación de normalidad

* Inspección visual de la normalidad de la variable 'UltCost':

Un gráfico Q-Q normal nos muestra como se aproximan estos datos a una distribución normal:

```{r}
qqnorm(claim$UltCost, main = "", xlab = "Cuantiles teóricos", ylab = "Cuantiles muestrales")
qqline(claim$UltCost)
```

Se observa que no siguen una distribución normal.
Esto es más fácil de visualizar con un histograma de densidad y una curva de distribución normal superpuesta:

```{r}
hist(claim$UltCost, probability = TRUE, main = "UltCost", xlab = "Población", ylab = "Densidad",  breaks=20)
x   <- seq(min(claim$UltCost), max(claim$UltCost), length = 1000)
y <- dnorm(x, mean(claim$UltCost), sd(claim$UltCost))
lines(x, y, col = "blue")
```

* Contraste de normalidad de Lilliefors:

```{r}
lillie.test(claim$UltCost)
```

Como p-value es menor de 0.05 se rechaza la hipótesis de normalidad.

* Inspección visual y contraste de la normalidad de la variable 'UltCost' en escala logarítmica:

Un gráfico Q-Q normal nos muestra como se aproximan estos datos a una distribución normal:

```{r}
qqnorm(logUltCost, main = "", xlab = "Cuantiles teóricos", ylab = "Cuantiles muestrales")
qqline(logUltCost)
```

Se observa que siguen una distribución normal.
Esto es más fácil de visualizar con un histograma de densidad y una curva de distribución normal superpuesta:

```{r}
hist(logUltCost, probability = TRUE, main = "LogUltCost", xlab = "Población", ylab = "Densidad",  breaks=20)
x   <- seq(min(logUltCost), max(logUltCost), length = 1000)
y <- dnorm(x, mean(logUltCost), sd(logUltCost))
lines(x, y, col = "red")
```

Contraste de normalidad de Lilliefors:

```{r}
lillie.test(logUltCost)
```

Como p-value es mayor de 0.05 se acepta la hipótesis de normalidad.

## Intervalo de confianza de la media poblaciona de la variable 'UltCost'

* Cálculo manual del intervalo de confianza al 95% de la media poblacional de la variable 'UltCost':

Media:
```{r}
print(mean(claim$UltCost))
```

Intervalo de confianza:
```{r}
n <- nrow(claim)
alpha <- (1-0.95)
SE <- sd(claim$UltCost) / sqrt(n)
t <- qnorm(alpha/2, lower.tail=FALSE)
L <- mean(claim$UltCost) - t*SE
U <- mean(claim$UltCost) + t*SE
c(L,U)
```



* ¿Podemos asumir la hipótesis de normalidad para el cálculo del intervalo de confianza sobre la media muestral del coste en escala original?

El Teorema del Límite Central (TLC) establece que el contraste de hipótesis sobre la media de una muestra se aproxima a una distribución normal aunque la población original no siga una distribución normal, siempre que el tamaño de la muestra sea suficientemente grande, es decir, mayor de 30. Asi que en este caso, se cumple el TLC y por o tanto podemos asumir la hipótesis de normalidad para el cálculo del intervalo de confianza sobre la media muestral.

* Interpretación del intervalo de confianza:

Si obtenemos infinitas muestras del conjunto de datos, el 95% de los intervalos de confianza calculados a partir de esas muestras contendrían el valor medio del coste.

******
# Coste inicial y final de los siniestros  
******

## Justificación del test a aplicar

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Hipótesis nula y alternativa

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Cálculos

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Conclusión

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Comprobación

```{r}

```

Finalmente, se asignan los nuevos códigos:

******
# Diferencia de salario según género  
******

## Análisis visual

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Interpretación

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Hipótesis nula y alternativa

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Justificación del test a aplicar

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Cálculos

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Conclusión

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Comprobación

```{r}

```

Finalmente, se asignan los nuevos códigos:

******
# Salario semanal (II)  
******

## Hipótesis nula y alternativa

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Justificación del test a aplicar

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Cálculos

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Conclusión

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Comprobación

```{r}

```

Finalmente, se asignan los nuevos códigos:

******
# Diferencia de jornada según género 
******

## Análisis visual

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Interpretación

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Hipótesis y alternativa

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Tipo de test

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Cálculos

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Conclusión

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Comprobación

```{r}

```

******
# Salario por hora 
******

## Hipótesis nula y alternativa

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Tipo de test

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Cálculos

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Conclusión

```{r}

```

Finalmente, se asignan los nuevos códigos:

## Comprobación

```{r}

```

Finalmente, se asignan los nuevos códigos:

******
# Resumen ejecutivo 
******

finalmente, se asignan los nuevos códigos:

******
# Bibliografía
******

* Apuntes y recursos de la asignatura.